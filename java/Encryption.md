Java 编码，加密，消息摘要，数字签名，数字证书和HTTPS

## Base64 编码
Base64 是一种很常见的编码规范，其作用是将二进制序列转换为人类可读的 ASCII 字符序列，常用在需用通过文本协议（比如 HTTP 和 SMTP）来传输二进制数据的情况下。Base64 并不是加密解密算法，尽管我们有时也听到使用 Base64 来加密解密的说法，但这里所说的加密与解密实际是指**编码（encode）和解码（decode）**的过程，其变换是非常简单的，算法完全公开,没有保密作用。

另一种使用场景是将多行文字转为单行文字，例如JWT，或放置数据到URL上。

### 具体实现
java.util.Base64 (JDK8)

或 apache common codec的Base64
String encodeBase64String(final byte[] binaryData) 
byte[] decodeBase64(final String base64String)
    
## 对称加密算法 symmetric[sɪ'metrɪk]  encryption algorithm
对称加密算法是应用较早的加密算法，技术成熟。在对称加密算法中，数据发信方将明文（原始数据）和加密密钥（secret key）一起经过特殊加密算法处理后，使其变成复杂的加密密文发送出去。收信方收到密文后，若想解读原文，则需要使用加密用过的密钥及相同算法的逆算法对密文进行解密，才能使其恢复成可读明文。在对称加密算法中，使用的密钥只有一个，发收信双方都使用这个密钥对数据进行加密和解密，这就要求解密方事先必须知道加密密钥。

### 优点
性能好。
### 缺点
算法是公开的，密钥只有一个且需要发布出去，安全性得不到保证。

### 常用算法

对称加密算法主要有 DES、3DES（TripleDES）、AES、IDEA、RC2、RC4、RC5 和 Blowfish 等。

## 非对称加密 Asymmetric encryption
非对称加密算法和对称加密算法的主要差别在于非对称加密算法用于加密和解密的密钥是不同的。一个公开，称为公钥（public key）；一个保密，称为私钥（private key）。因此，非对称加密算法也称为双钥加密算法或公钥加密算法。

### 优点

非对称加密算法解决了对称加密算法的密钥分配问题，并极大地提高了算法安全性。

### 缺点

算法比对称算法更复杂，因此加密、解密速度都比对称算法慢很多。

### 常用算法
DH(Diffie-Hellman，密钥交换算法)、RSA

## 消息摘要
### 常用算法

消息摘要算法包括MD(Message Digest，消息摘要算法)、SHA(Secure Hash Algorithm，安全散列算法)、**MAC(Message AuthenticationCode，消息认证码算法)**共 3 大系列，常用于验证数据的完整性，是数字签名算法的核心算法。

MD5和SHA1分别是MD、SHA算法系列中最有代表性的算法。

如今，MD5 已被发现有许多漏洞，从而不再安全。SHA 算法比 MD 算法的摘要长度更长，也更加安全。

## 数字签名（digital signature）
数字签名算法可以看做是一种带有密钥的消息摘要算法，并且这种密钥包含了公钥和私钥。也就是说，数字签名算法是非对称加密算法和消息摘要算法的结合体。

### 特点
数字签名算法要求能够验证数据完整性、通过它可以判断数据是否被篡改，认证数据来源。

### 原理/处理过程
数字签名算法包含签名和验证两项操作，遵循私钥签名，公钥验证的方式。

签名时要使用私钥和待签名数据，验证时则需要公钥、签名值和待签名数据，其核心算法主要是消息摘要算法。

**签名过程：**
原始信息 ---hash---> 信息摘要 ---私钥加密---> 数字证书

**验证过程：**
原始信息 ---hash---> 信息摘要1
数字证书 ---公钥解密---> 信息摘要2
比较摘要1，摘要2是否相等，相等则验证通过。

### 遗留问题
1.怎么判断public key没有被篡改过？
2.如果信息要发给很多人，他们怎么方便的获得public key。
这些问题可以靠数字证书来解决。

## 数字证书（digital certificate）
数字证书的目的是提供一个途径来发现public key，并且验证这个key是合法的。
证书中包含了公钥，有效期，颁发者，公钥所有者等信息。

**CA: Certificate authority 证书认证机构：** 负责发放和管理数字证书的第三方权威机构

### 过程
1. 首先A去找"证书中心"（certificate authority，简称CA），为A的公钥做认证。证书中心用自己的私钥，对A的公钥和一些相关信息一起加密，生成"数字证书"（Digital Certificate）：
2. A在邮件正文下方除了数字签名，另外加上这张数字证书
3. B收到Email后用CA的公钥解密这份数字证书，拿到A的公钥，然后验证数字签名，后面流程不再赘述。

## https综合使用了非对称加密和对称加密
为了速度起见，https 连接只在建立连接时，使用服务器的公钥加密，这个阶段是为了交换一个共享密钥。接下来的过程使用的是对称算法。
通常公开钥算法用于相互验证，之后会建立session key（比如128位AES key）。后续交互的信息都是用session key和对称加密算法（比如AES）来加解密的，已经与证书本身和公钥密钥无关。因为公开密钥算法比对称密钥算法开销大很多。

### https的交互过程：
https://zhuanlan.zhihu.com/p/97154765
![https的交互过程](https://pic2.zhimg.com/80/v2-b3288ea1a0faf4d9823f57dfc81f7995_720w.jpg)
① 证书验证阶段：
1）浏览器发起 HTTPS 请求；
2）服务端返回 HTTPS 证书；
3）客户端验证证书是否合法，如果不合法则提示告警。

② 数据传输阶段：
1）当证书验证合法后，在本地生成随机数；
2）通过公钥加密随机数，并把加密后的随机数传输到服务端；
3）服务端通过私钥对随机数进行解密；
4）服务端通过客户端传入的随机数构造对称加密算法，对返回结果内容进行加密后传输。

### http的安全缺陷
1. 无法验证服务端的身份
2. 无法保证数据完整性
3. 无法保证数据传输不被窃听
